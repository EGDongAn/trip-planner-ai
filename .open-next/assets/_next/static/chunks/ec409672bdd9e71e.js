(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,63886,e=>{"use strict";var t=e.i(43476),a=e.i(71645);let s={stage:"initial",userInput:"",destinationOptions:[],selectedDestination:null,planOptions:[],selectedPlan:null,timeline:[],conversation:[],metadata:{travelers:2,departureDate:"",returnDate:"",departureCity:"",preferences:[]}};var l=e.i(75254);let i=(0,l.default)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),n=(0,l.default)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]),r=(0,l.default)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);var c=e.i(83086);let d=({variant:e="primary",children:a,className:s="",disabled:l,...i})=>(0,t.jsx)("button",{className:`px-6 py-3 rounded-lg font-medium transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-slate-900 disabled:opacity-50 disabled:cursor-not-allowed ${{primary:"bg-blue-600 hover:bg-blue-700 text-white focus:ring-blue-500",secondary:"bg-slate-700 hover:bg-slate-600 text-white focus:ring-slate-500",outline:"border-2 border-slate-600 hover:border-blue-500 text-slate-200 hover:text-blue-400 focus:ring-blue-500"}[e]} ${s}`,disabled:l,...i,children:a}),o=({label:e,error:a,className:s="",...l})=>(0,t.jsxs)("div",{className:"w-full",children:[e&&(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:e}),(0,t.jsx)("input",{className:`
          w-full px-4 py-3
          bg-slate-800 border border-slate-700
          rounded-lg text-slate-200
          placeholder:text-slate-500
          focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent
          transition-all duration-200
          ${a?"border-red-500 focus:ring-red-500":""}
          ${s}
        `,...l}),a&&(0,t.jsx)("p",{className:"mt-1 text-sm text-red-400",children:a})]}),m=({onSubmit:e,isLoading:s=!1})=>{let[l,m]=(0,a.useState)(""),[x,h]=(0,a.useState)(!1),[p,u]=(0,a.useState)(""),[g,y]=(0,a.useState)(2),[f,j]=(0,a.useState)(""),[b,v]=(0,a.useState)("");return(0,t.jsxs)("form",{onSubmit:t=>{t.preventDefault(),e({query:l,origin:p||void 0,travelers:g||void 0,startDate:f||void 0,endDate:b||void 0})},className:"w-full max-w-4xl mx-auto space-y-4",children:[(0,t.jsx)("div",{className:"relative",children:(0,t.jsx)("textarea",{value:l,onChange:e=>m(e.target.value),placeholder:"12월 따뜻한 곳에서 부모님과 5박 6일 여행을 계획하고 싶어요...",className:"w-full px-6 py-4 bg-slate-800 border border-slate-700 rounded-xl text-slate-200 placeholder:text-slate-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 resize-none",rows:3,required:!0})}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("button",{type:"button",onClick:()=>h(!x),className:"text-sm text-slate-400 hover:text-blue-400 transition-colors",children:x?"간단히 입력하기":"상세 옵션 표시"}),(0,t.jsxs)(d,{type:"submit",variant:"primary",disabled:s||!l.trim(),children:[(0,t.jsx)(c.Sparkles,{className:"w-5 h-5 mr-2 inline"}),"여행 계획 생성"]})]}),x&&(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 p-4 bg-slate-800/50 rounded-xl",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(i,{className:"w-5 h-5 text-slate-400"}),(0,t.jsx)(o,{type:"text",placeholder:"출발지",value:p,onChange:e=>u(e.target.value),className:"text-sm"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(n,{className:"w-5 h-5 text-slate-400"}),(0,t.jsx)(o,{type:"number",placeholder:"인원수",value:g||"",onChange:e=>y(parseInt(e.target.value)||0),min:1,className:"text-sm"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(r,{className:"w-5 h-5 text-slate-400"}),(0,t.jsx)(o,{type:"date",placeholder:"출발일",value:f,onChange:e=>j(e.target.value),className:"text-sm"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(r,{className:"w-5 h-5 text-slate-400"}),(0,t.jsx)(o,{type:"date",placeholder:"귀국일",value:b,onChange:e=>v(e.target.value),className:"text-sm"})]})]})]})},x=(0,l.default)("dollar-sign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),h=(0,l.default)("cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]),p=(0,l.default)("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]),u=({children:e,className:a="",onClick:s,selected:l=!1,hoverable:i=!0})=>{let n=s?"cursor-pointer":"";return(0,t.jsx)("div",{className:`bg-slate-800 rounded-xl p-6 transition-all duration-200 ${i?"hover:bg-slate-750 hover:shadow-lg hover:shadow-blue-500/10":""} ${l?"ring-2 ring-blue-500 shadow-lg shadow-blue-500/20":""} ${n} ${a}`,onClick:s,children:e})},g=({destinations:e,selectedId:a,onSelect:s})=>(0,t.jsxs)("div",{className:"w-full",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-slate-100 mb-6",children:"추천 여행지"}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4",children:e.map(e=>(0,t.jsxs)(u,{selected:a===e.id,onClick:()=>s(e),className:"flex flex-col h-full",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-bold text-slate-100",children:e.name}),(0,t.jsxs)("div",{className:"flex items-center gap-1 text-sm text-slate-400 mt-1",children:[(0,t.jsx)(i,{className:"w-4 h-4"}),(0,t.jsx)("span",{children:e.country})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1 bg-blue-500/20 text-blue-400 px-2 py-1 rounded-lg text-xs font-medium",children:[(0,t.jsx)(p,{className:"w-3 h-3"}),(0,t.jsxs)("span",{children:[Math.round(100*e.matchScore),"%"]})]})]}),(0,t.jsxs)("div",{className:"flex-1 space-y-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"text-xs font-medium text-slate-400 mb-1",children:"하이라이트"}),(0,t.jsx)("ul",{className:"space-y-1",children:e.highlights.slice(0,3).map((e,a)=>(0,t.jsxs)("li",{className:"text-sm text-slate-300 flex items-start gap-1",children:[(0,t.jsx)("span",{className:"text-blue-400 mt-1",children:"•"}),(0,t.jsx)("span",{children:e})]},a))})]}),(0,t.jsxs)("div",{className:"pt-3 border-t border-slate-700 space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,t.jsx)(x,{className:"w-4 h-4 text-slate-400"}),(0,t.jsxs)("span",{className:"text-slate-300",children:[e.estimatedCost.currency," ",e.estimatedCost.min.toLocaleString()," - ",e.estimatedCost.max.toLocaleString()]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,t.jsx)(h,{className:"w-4 h-4 text-slate-400"}),(0,t.jsxs)("span",{className:"text-slate-300",children:[e.weather.temperature," • ",e.weather.condition]})]})]})]})]},e.id))})]}),y=(0,l.default)("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),f={relaxed:{label:"여유로운",icon:(0,l.default)("heart",[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]]),color:"text-green-400 bg-green-500/20"},moderate:{label:"적당한",icon:y,color:"text-blue-400 bg-blue-500/20"},active:{label:"활동적인",icon:y,color:"text-orange-400 bg-orange-500/20"}},j=({plans:e,selectedId:a,onSelect:s})=>(0,t.jsxs)("div",{className:"w-full",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-slate-100 mb-6",children:"여행 플랜 선택"}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:e.map(e=>{let l=f[e.pace],i=l.icon;return(0,t.jsxs)(u,{selected:a===e.id,onClick:()=>s(e),className:"flex flex-col h-full",children:[(0,t.jsx)("div",{className:"flex items-start justify-between mb-4",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-lg bg-blue-500/20 text-blue-400 flex items-center justify-center text-xl font-bold",children:e.label}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-xl font-bold text-slate-100",children:e.name}),(0,t.jsxs)("div",{className:`flex items-center gap-1 mt-1 text-xs font-medium px-2 py-1 rounded ${l.color}`,children:[(0,t.jsx)(i,{className:"w-3 h-3"}),(0,t.jsx)("span",{children:l.label})]})]})]})}),(0,t.jsx)("p",{className:"text-sm text-slate-400 mb-4",children:e.description}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("h4",{className:"text-xs font-medium text-slate-400 mb-2",children:"주요 특징"}),(0,t.jsx)("ul",{className:"space-y-2",children:e.highlights.map((e,a)=>(0,t.jsxs)("li",{className:"text-sm text-slate-300 flex items-start gap-2",children:[(0,t.jsx)("span",{className:"text-blue-400 mt-1",children:"•"}),(0,t.jsx)("span",{children:e})]},a))})]}),(0,t.jsx)("div",{className:"pt-4 mt-4 border-t border-slate-700",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-slate-400",children:"예상 비용"}),(0,t.jsxs)("div",{className:"flex items-center gap-1 text-lg font-bold text-slate-100",children:[(0,t.jsx)(x,{className:"w-5 h-5"}),(0,t.jsxs)("span",{children:[e.estimatedCost.total.toLocaleString()," ",e.estimatedCost.currency]})]})]})})]},e.id)})})]}),b=(0,l.default)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),v=(0,l.default)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),N=(0,l.default)("coffee",[["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M14 2v2",key:"6buw04"}],["path",{d:"M16 8a1 1 0 0 1 1 1v8a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1h14a4 4 0 1 1 0 8h-1",key:"pwadti"}],["path",{d:"M6 2v2",key:"colzsn"}]]),k=(0,l.default)("utensils",[["path",{d:"M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2",key:"cjf0a3"}],["path",{d:"M7 2v20",key:"1473qp"}],["path",{d:"M21 15V2a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7",key:"j28e5"}]]),w={transport:{icon:(0,l.default)("plane",[["path",{d:"M17.8 19.2 16 11l3.5-3.5C21 6 21.5 4 21 3c-1-.5-3 0-4.5 1.5L13 8 4.8 6.2c-.5-.1-.9.1-1.1.5l-.3.5c-.2.5-.1 1 .3 1.3L9 12l-2 3H4l-1 1 3 2 2 3 1-1v-3l3-2 3.5 5.3c.3.4.8.5 1.3.3l.5-.2c.4-.3.6-.7.5-1.2z",key:"1v9wt8"}]]),color:"text-blue-400 bg-blue-500/20",label:"이동"},food:{icon:k,color:"text-orange-400 bg-orange-500/20",label:"식사"},activity:{icon:(0,l.default)("camera",[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]),color:"text-green-400 bg-green-500/20",label:"활동"},accommodation:{icon:N,color:"text-purple-400 bg-purple-500/20",label:"숙소"},shopping:{icon:(0,l.default)("shopping-bag",[["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}],["path",{d:"M3.103 6.034h17.794",key:"awc11p"}],["path",{d:"M3.4 5.467a2 2 0 0 0-.4 1.2V20a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6.667a2 2 0 0 0-.4-1.2l-2-2.667A2 2 0 0 0 17 2H7a2 2 0 0 0-1.6.8z",key:"o988cm"}]]),color:"text-pink-400 bg-pink-500/20",label:"쇼핑"},entertainment:{icon:(0,l.default)("music",[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]]),color:"text-yellow-400 bg-yellow-500/20",label:"엔터테인먼트"}},M=({item:e})=>{let a=w[e.category],s=a.icon;return(0,t.jsxs)("div",{className:"flex items-center gap-4 p-4 bg-slate-800 rounded-lg hover:bg-slate-750 transition-all duration-200 group",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 min-w-[100px]",children:[(0,t.jsx)(b,{className:"w-4 h-4 text-slate-400"}),(0,t.jsx)("span",{className:"text-sm font-medium text-slate-300",children:e.time})]}),(0,t.jsx)("div",{className:`p-2 rounded-lg ${a.color}`,children:(0,t.jsx)(s,{className:"w-5 h-5"})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("h4",{className:"text-sm font-medium text-slate-100 mb-1",children:e.activity}),(0,t.jsxs)("div",{className:"flex items-center gap-2 text-xs text-slate-400",children:[(0,t.jsx)(i,{className:"w-3 h-3"}),(0,t.jsx)("span",{className:"truncate",children:e.location})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[e.cost&&(0,t.jsxs)("div",{className:"flex items-center gap-1 text-sm text-slate-300",children:[(0,t.jsx)(x,{className:"w-4 h-4 text-slate-400"}),(0,t.jsxs)("span",{children:[e.cost.amount.toLocaleString()," ",e.cost.currency]})]}),e.verified&&(0,t.jsxs)("div",{className:"flex items-center gap-1 bg-green-500/20 text-green-400 px-2 py-1 rounded text-xs font-medium",children:[(0,t.jsx)(v,{className:"w-3 h-3"}),(0,t.jsx)("span",{children:"확인됨"})]})]})]})},C=({schedule:e,totalCost:a})=>(0,t.jsxs)("div",{className:"w-full",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-slate-100",children:"상세 일정"}),a&&(0,t.jsxs)("div",{className:"flex items-center gap-2 bg-slate-800 px-4 py-2 rounded-lg",children:[(0,t.jsx)(x,{className:"w-5 h-5 text-slate-400"}),(0,t.jsx)("span",{className:"text-sm text-slate-400",children:"총 예상 비용:"}),(0,t.jsxs)("span",{className:"text-lg font-bold text-slate-100",children:[a.amount.toLocaleString()," ",a.currency]})]})]}),(0,t.jsx)("div",{className:"space-y-6",children:e.map(e=>(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between sticky top-0 bg-slate-900 py-3 z-10",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-8 h-8 rounded-lg bg-blue-500/20 text-blue-400 flex items-center justify-center text-sm font-bold",children:e.dayNumber}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(r,{className:"w-4 h-4 text-slate-400"}),(0,t.jsx)("span",{className:"text-lg font-semibold text-slate-100",children:new Date(e.date).toLocaleDateString("ko-KR",{month:"long",day:"numeric",weekday:"short"})})]})]}),e.dailyCost&&(0,t.jsxs)("div",{className:"flex items-center gap-1 text-sm text-slate-300",children:[(0,t.jsx)(x,{className:"w-4 h-4 text-slate-400"}),(0,t.jsxs)("span",{children:[e.dailyCost.total.toLocaleString()," ",e.dailyCost.currency]})]})]}),(0,t.jsx)("div",{className:"space-y-2 pl-11",children:e.items.map(e=>(0,t.jsx)(M,{item:e},e.id))})]},e.date))})]});var S=e.i(60127);function D(){let{tripState:e,isLoading:l,error:i,generateDestinations:n,selectDestination:r,selectPlan:c,refineTimeline:d,resetTrip:o,updateMetadata:x}=function(){let[e,t]=(0,a.useState)(s),[l,i]=(0,a.useState)(!1),[n,r]=(0,a.useState)(null),c=(0,a.useCallback)(async(e,a)=>{i(!0),r(null);try{let s=await fetch("/api/trip/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userInput:e,metadata:a})});if(!s.ok)throw Error(`Failed to generate destinations: ${s.statusText}`);let l=await s.json();t(t=>({...t,stage:"choose_destination",userInput:e,metadata:a,destinationOptions:l.destinations,conversation:[...t.conversation,{id:crypto.randomUUID(),role:"user",content:e,timestamp:new Date,metadata:{stage:"initial",action:void 0}}]}))}catch(e){r(e instanceof Error?e.message:"Failed to generate destinations"),console.error("Error generating destinations:",e)}finally{i(!1)}},[]),d=(0,a.useCallback)(async a=>{i(!0),r(null);try{let s=await fetch("/api/trip/select-destination",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({destination:a,metadata:e.metadata})});if(!s.ok)throw Error(`Failed to select destination: ${s.statusText}`);let l=await s.json();t(e=>({...e,stage:"choose_plan",selectedDestination:a,planOptions:l.plans,conversation:[...e.conversation,{id:crypto.randomUUID(),role:"user",content:`I'd like to visit ${a.name}, ${a.country}`,timestamp:new Date,metadata:{stage:"choose_destination",action:"select_destination",data:a}}]}))}catch(e){r(e instanceof Error?e.message:"Failed to select destination"),console.error("Error selecting destination:",e)}finally{i(!1)}},[e.metadata]),o=(0,a.useCallback)(async a=>{if(!e.selectedDestination)return void r("No destination selected");i(!0),r(null);try{let s=await fetch("/api/trip/select-plan",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({destination:e.selectedDestination,plan:a,metadata:e.metadata})});if(!s.ok)throw Error(`Failed to select plan: ${s.statusText}`);let l=await s.json();t(e=>({...e,stage:"itinerary_ready",selectedPlan:a,timeline:l.timeline,conversation:[...e.conversation,{id:crypto.randomUUID(),role:"user",content:`I'd like to go with Plan ${a.label}: ${a.name}`,timestamp:new Date,metadata:{stage:"choose_plan",action:"select_plan",data:a}},{id:crypto.randomUUID(),role:"assistant",content:l.initialMessage||"Great choice! Here's your personalized itinerary. You can chat with me to refine it.",timestamp:new Date,metadata:{stage:"itinerary_ready"}}]}))}catch(e){r(e instanceof Error?e.message:"Failed to select plan"),console.error("Error selecting plan:",e)}finally{i(!1)}},[e.selectedDestination,e.metadata]),m=(0,a.useCallback)(async a=>{if(!e.selectedDestination||!e.selectedPlan)return void r("No destination or plan selected");i(!0),r(null);let s={id:crypto.randomUUID(),role:"user",content:a,timestamp:new Date,metadata:{stage:"itinerary_ready",action:"modify_timeline"}};t(e=>({...e,conversation:[...e.conversation,s]}));try{let s=await fetch("/api/trip/refine",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:a,currentTimeline:e.timeline,destination:e.selectedDestination,plan:e.selectedPlan,metadata:e.metadata,conversationHistory:e.conversation})});if(!s.ok)throw Error(`Failed to refine timeline: ${s.statusText}`);let l=await s.json();t(e=>({...e,timeline:l.timeline,conversation:[...e.conversation,{id:crypto.randomUUID(),role:"assistant",content:l.response,timestamp:new Date,metadata:{stage:"itinerary_ready"}}]}))}catch(e){r(e instanceof Error?e.message:"Failed to refine timeline"),console.error("Error refining timeline:",e),t(e=>({...e,conversation:e.conversation.filter(e=>e.id!==s.id)}))}finally{i(!1)}},[e.selectedDestination,e.selectedPlan,e.timeline,e.metadata,e.conversation]);return{tripState:e,isLoading:l,error:n,generateDestinations:c,selectDestination:d,selectPlan:o,refineTimeline:m,resetTrip:(0,a.useCallback)(()=>{t(s),r(null)},[]),updateMetadata:(0,a.useCallback)(e=>{t(t=>({...t,metadata:{...t.metadata,...e}}))},[])}}();return(0,t.jsxs)("div",{className:"space-y-6",children:[i&&(0,t.jsxs)("div",{className:"bg-red-50 border border-red-200 text-red-800 px-4 py-3 rounded-lg dark:bg-red-950 dark:border-red-800 dark:text-red-200",children:[(0,t.jsx)("p",{className:"font-medium",children:"Error"}),(0,t.jsx)("p",{className:"text-sm mt-1",children:i})]}),"initial"===e.stage&&(0,t.jsx)(m,{onSubmit:e=>{let t={travelers:e.travelers||2,departureDate:e.startDate||"",returnDate:e.endDate||"",departureCity:e.origin||"",preferences:[]};n(e.query,t)},isLoading:l}),"choose_destination"===e.stage&&(0,t.jsx)(g,{destinations:e.destinationOptions.map(e=>({id:e.id,name:e.name,country:e.country,highlights:e.highlights,estimatedCost:e.estimatedBudget,weather:{temperature:e.weatherNote||"N/A",condition:"N/A"},matchScore:e.matchScore})),onSelect:t=>{let a=e.destinationOptions.find(e=>e.id===t.id);a&&r(a)}}),"choose_plan"===e.stage&&e.selectedDestination&&(0,t.jsx)(j,{plans:e.planOptions.map(e=>({id:e.id,label:e.label,name:e.name,description:e.description,pace:"intense"===e.pace?"active":e.pace,highlights:e.highlights,estimatedCost:{total:(e.estimatedCost.min+e.estimatedCost.max)/2,currency:e.estimatedCost.currency}})),onSelect:t=>{let a=e.planOptions.find(e=>e.id===t.id);a&&c(a)}}),"itinerary_ready"===e.stage&&e.selectedDestination&&e.selectedPlan&&(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,t.jsx)("div",{className:"lg:col-span-1",children:(0,t.jsx)(C,{schedule:Object.values(e.timeline.reduce((e,t)=>{let a=t.day;e[a]||(e[a]={date:t.date,dayNumber:t.day,items:[]});let s="activity";return"free"===t.category?s="activity":["transport","food","accommodation"].includes(t.category)&&(s=t.category),e[a].items.push({id:t.id,time:t.time,activity:t.activity,location:t.location,category:s,cost:t.cost,verified:t.verified}),e},{})).sort((e,t)=>e.dayNumber-t.dayNumber),totalCost:{amount:e.selectedPlan.estimatedCost.min,currency:e.selectedPlan.estimatedCost.currency}})}),(0,t.jsx)("div",{className:"lg:col-span-1",children:(0,t.jsx)(S.ChatContainer,{messages:e.conversation,onSendMessage:d,disabled:l})})]}),l&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black/20 dark:bg-black/40 backdrop-blur-sm flex items-center justify-center z-50",children:(0,t.jsx)("div",{className:"bg-white dark:bg-zinc-800 rounded-lg p-6 shadow-xl",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),(0,t.jsxs)("p",{className:"text-zinc-900 dark:text-zinc-50 font-medium",children:["initial"===e.stage&&"Generating destination options...","choose_destination"===e.stage&&"Creating travel plans...","choose_plan"===e.stage&&"Building your itinerary...","itinerary_ready"===e.stage&&"Refining your trip..."]})]})})})]})}e.i(83233),e.i(19684),e.i(71337),e.i(47167),(0,l.default)("external-link",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]),(0,l.default)("hotel",[["path",{d:"M10 22v-6.57",key:"1wmca3"}],["path",{d:"M12 11h.01",key:"z322tv"}],["path",{d:"M12 7h.01",key:"1ivr5q"}],["path",{d:"M14 15.43V22",key:"1q2vjd"}],["path",{d:"M15 16a5 5 0 0 0-6 0",key:"o9wqvi"}],["path",{d:"M16 11h.01",key:"xkw8gn"}],["path",{d:"M16 7h.01",key:"1kdx03"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 7h.01",key:"1vti4s"}],["rect",{x:"4",y:"2",width:"16",height:"20",rx:"2",key:"1uxh74"}]]),(0,l.default)("wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]),(0,l.default)("dumbbell",[["path",{d:"M17.596 12.768a2 2 0 1 0 2.829-2.829l-1.768-1.767a2 2 0 0 0 2.828-2.829l-2.828-2.828a2 2 0 0 0-2.829 2.828l-1.767-1.768a2 2 0 1 0-2.829 2.829z",key:"9m4mmf"}],["path",{d:"m2.5 21.5 1.4-1.4",key:"17g3f0"}],["path",{d:"m20.1 3.9 1.4-1.4",key:"1qn309"}],["path",{d:"M5.343 21.485a2 2 0 1 0 2.829-2.828l1.767 1.768a2 2 0 1 0 2.829-2.829l-6.364-6.364a2 2 0 1 0-2.829 2.829l1.768 1.767a2 2 0 0 0-2.828 2.829z",key:"1t2c92"}],["path",{d:"m9.6 14.4 4.8-4.8",key:"6umqxw"}]]),(0,l.default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]),(0,l.default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),e.s(["default",()=>D],63886)}]);