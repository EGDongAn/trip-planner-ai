(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[624],{1140:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>T});var s=a(5155),l=a(2115);let i={stage:"initial",userInput:"",destinationOptions:[],selectedDestination:null,planOptions:[],selectedPlan:null,timeline:[],conversation:[],metadata:{travelers:2,departureDate:"",returnDate:"",departureCity:"",preferences:[]}};var n=a(5740),r=a(1847);let c=(0,r.A)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),d=(0,r.A)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]),o=(0,r.A)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]),m=e=>{let{variant:t="primary",children:a,className:l="",disabled:i,...n}=e;return(0,s.jsx)("button",{className:"".concat("px-6 py-3 rounded-lg font-medium transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-slate-900 disabled:opacity-50 disabled:cursor-not-allowed"," ").concat({primary:"bg-blue-600 hover:bg-blue-700 text-white focus:ring-blue-500",secondary:"bg-slate-700 hover:bg-slate-600 text-white focus:ring-slate-500",outline:"border-2 border-slate-600 hover:border-blue-500 text-slate-200 hover:text-blue-400 focus:ring-blue-500"}[t]," ").concat(l),disabled:i,...n,children:a})},x=e=>{let{label:t,error:a,className:l="",...i}=e;return(0,s.jsxs)("div",{className:"w-full",children:[t&&(0,s.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:t}),(0,s.jsx)("input",{className:"\n          w-full px-4 py-3\n          bg-slate-800 border border-slate-700\n          rounded-lg text-slate-200\n          placeholder:text-slate-500\n          focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent\n          transition-all duration-200\n          ".concat(a?"border-red-500 focus:ring-red-500":"","\n          ").concat(l,"\n        "),...i}),a&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-400",children:a})]})},h=e=>{let{onSubmit:t,isLoading:a=!1}=e,[i,r]=(0,l.useState)(""),[h,u]=(0,l.useState)(!1),[p,g]=(0,l.useState)(""),[b,f]=(0,l.useState)(2),[y,j]=(0,l.useState)(""),[v,N]=(0,l.useState)("");return(0,s.jsxs)("form",{onSubmit:e=>{e.preventDefault(),t({query:i,origin:p||void 0,travelers:b||void 0,startDate:y||void 0,endDate:v||void 0})},className:"w-full max-w-4xl mx-auto space-y-4",children:[(0,s.jsx)("div",{className:"relative",children:(0,s.jsx)("textarea",{value:i,onChange:e=>r(e.target.value),placeholder:"12월 따뜻한 곳에서 부모님과 5박 6일 여행을 계획하고 싶어요...",className:"w-full px-6 py-4 bg-slate-800 border border-slate-700 rounded-xl text-slate-200 placeholder:text-slate-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 resize-none",rows:3,required:!0})}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("button",{type:"button",onClick:()=>u(!h),className:"text-sm text-slate-400 hover:text-blue-400 transition-colors",children:h?"간단히 입력하기":"상세 옵션 표시"}),(0,s.jsxs)(m,{type:"submit",variant:"primary",disabled:a||!i.trim(),children:[(0,s.jsx)(n.A,{className:"w-5 h-5 mr-2 inline"}),"여행 계획 생성"]})]}),h&&(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 p-4 bg-slate-800/50 rounded-xl",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(c,{className:"w-5 h-5 text-slate-400"}),(0,s.jsx)(x,{type:"text",placeholder:"출발지",value:p,onChange:e=>g(e.target.value),className:"text-sm"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(d,{className:"w-5 h-5 text-slate-400"}),(0,s.jsx)(x,{type:"number",placeholder:"인원수",value:b||"",onChange:e=>f(parseInt(e.target.value)||0),min:1,className:"text-sm"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(o,{className:"w-5 h-5 text-slate-400"}),(0,s.jsx)(x,{type:"date",placeholder:"출발일",value:y,onChange:e=>j(e.target.value),className:"text-sm"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(o,{className:"w-5 h-5 text-slate-400"}),(0,s.jsx)(x,{type:"date",placeholder:"귀국일",value:v,onChange:e=>N(e.target.value),className:"text-sm"})]})]})]})},u=(0,r.A)("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]),p=(0,r.A)("dollar-sign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),g=(0,r.A)("cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]),b=e=>{let{children:t,className:a="",onClick:l,selected:i=!1,hoverable:n=!0}=e;return(0,s.jsx)("div",{className:"".concat("bg-slate-800 rounded-xl p-6 transition-all duration-200"," ").concat(n?"hover:bg-slate-750 hover:shadow-lg hover:shadow-blue-500/10":""," ").concat(i?"ring-2 ring-blue-500 shadow-lg shadow-blue-500/20":""," ").concat(l?"cursor-pointer":""," ").concat(a),onClick:l,children:t})},f=e=>{let{destinations:t,selectedId:a,onSelect:l}=e;return(0,s.jsxs)("div",{className:"w-full",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-slate-100 mb-6",children:"추천 여행지"}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4",children:t.map(e=>(0,s.jsxs)(b,{selected:a===e.id,onClick:()=>l(e),className:"flex flex-col h-full",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-bold text-slate-100",children:e.name}),(0,s.jsxs)("div",{className:"flex items-center gap-1 text-sm text-slate-400 mt-1",children:[(0,s.jsx)(c,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:e.country})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-1 bg-blue-500/20 text-blue-400 px-2 py-1 rounded-lg text-xs font-medium",children:[(0,s.jsx)(u,{className:"w-3 h-3"}),(0,s.jsxs)("span",{children:[Math.round(100*e.matchScore),"%"]})]})]}),(0,s.jsxs)("div",{className:"flex-1 space-y-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-xs font-medium text-slate-400 mb-1",children:"하이라이트"}),(0,s.jsx)("ul",{className:"space-y-1",children:e.highlights.slice(0,3).map((e,t)=>(0,s.jsxs)("li",{className:"text-sm text-slate-300 flex items-start gap-1",children:[(0,s.jsx)("span",{className:"text-blue-400 mt-1",children:"•"}),(0,s.jsx)("span",{children:e})]},t))})]}),(0,s.jsxs)("div",{className:"pt-3 border-t border-slate-700 space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,s.jsx)(p,{className:"w-4 h-4 text-slate-400"}),(0,s.jsxs)("span",{className:"text-slate-300",children:[e.estimatedCost.currency," ",e.estimatedCost.min.toLocaleString()," - ",e.estimatedCost.max.toLocaleString()]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,s.jsx)(g,{className:"w-4 h-4 text-slate-400"}),(0,s.jsxs)("span",{className:"text-slate-300",children:[e.weather.temperature," • ",e.weather.condition]})]})]})]})]},e.id))})]})},y=(0,r.A)("heart",[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]]),j=(0,r.A)("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),v={relaxed:{label:"여유로운",icon:y,color:"text-green-400 bg-green-500/20"},moderate:{label:"적당한",icon:j,color:"text-blue-400 bg-blue-500/20"},active:{label:"활동적인",icon:j,color:"text-orange-400 bg-orange-500/20"}},N=e=>{let{plans:t,selectedId:a,onSelect:l}=e;return(0,s.jsxs)("div",{className:"w-full",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-slate-100 mb-6",children:"여행 플랜 선택"}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:t.map(e=>{let t=v[e.pace],i=t.icon;return(0,s.jsxs)(b,{selected:a===e.id,onClick:()=>l(e),className:"flex flex-col h-full",children:[(0,s.jsx)("div",{className:"flex items-start justify-between mb-4",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"w-10 h-10 rounded-lg bg-blue-500/20 text-blue-400 flex items-center justify-center text-xl font-bold",children:e.label}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-xl font-bold text-slate-100",children:e.name}),(0,s.jsxs)("div",{className:"flex items-center gap-1 mt-1 text-xs font-medium px-2 py-1 rounded ".concat(t.color),children:[(0,s.jsx)(i,{className:"w-3 h-3"}),(0,s.jsx)("span",{children:t.label})]})]})]})}),(0,s.jsx)("p",{className:"text-sm text-slate-400 mb-4",children:e.description}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h4",{className:"text-xs font-medium text-slate-400 mb-2",children:"주요 특징"}),(0,s.jsx)("ul",{className:"space-y-2",children:e.highlights.map((e,t)=>(0,s.jsxs)("li",{className:"text-sm text-slate-300 flex items-start gap-2",children:[(0,s.jsx)("span",{className:"text-blue-400 mt-1",children:"•"}),(0,s.jsx)("span",{children:e})]},t))})]}),(0,s.jsx)("div",{className:"pt-4 mt-4 border-t border-slate-700",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-slate-400",children:"예상 비용"}),(0,s.jsxs)("div",{className:"flex items-center gap-1 text-lg font-bold text-slate-100",children:[(0,s.jsx)(p,{className:"w-5 h-5"}),(0,s.jsxs)("span",{children:[e.estimatedCost.total.toLocaleString()," ",e.estimatedCost.currency]})]})]})})]},e.id)})})]})},k=(0,r.A)("plane",[["path",{d:"M17.8 19.2 16 11l3.5-3.5C21 6 21.5 4 21 3c-1-.5-3 0-4.5 1.5L13 8 4.8 6.2c-.5-.1-.9.1-1.1.5l-.3.5c-.2.5-.1 1 .3 1.3L9 12l-2 3H4l-1 1 3 2 2 3 1-1v-3l3-2 3.5 5.3c.3.4.8.5 1.3.3l.5-.2c.4-.3.6-.7.5-1.2z",key:"1v9wt8"}]]),w=(0,r.A)("utensils",[["path",{d:"M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2",key:"cjf0a3"}],["path",{d:"M7 2v20",key:"1473qp"}],["path",{d:"M21 15V2a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7",key:"j28e5"}]]),z=(0,r.A)("camera",[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]),C=(0,r.A)("coffee",[["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M14 2v2",key:"6buw04"}],["path",{d:"M16 8a1 1 0 0 1 1 1v8a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1h14a4 4 0 1 1 0 8h-1",key:"pwadti"}],["path",{d:"M6 2v2",key:"colzsn"}]]),M=(0,r.A)("shopping-bag",[["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}],["path",{d:"M3.103 6.034h17.794",key:"awc11p"}],["path",{d:"M3.4 5.467a2 2 0 0 0-.4 1.2V20a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6.667a2 2 0 0 0-.4-1.2l-2-2.667A2 2 0 0 0 17 2H7a2 2 0 0 0-1.6.8z",key:"o988cm"}]]),D=(0,r.A)("music",[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]]),S=(0,r.A)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),A=(0,r.A)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),_={transport:{icon:k,color:"text-blue-400 bg-blue-500/20",label:"이동"},food:{icon:w,color:"text-orange-400 bg-orange-500/20",label:"식사"},activity:{icon:z,color:"text-green-400 bg-green-500/20",label:"활동"},accommodation:{icon:C,color:"text-purple-400 bg-purple-500/20",label:"숙소"},shopping:{icon:M,color:"text-pink-400 bg-pink-500/20",label:"쇼핑"},entertainment:{icon:D,color:"text-yellow-400 bg-yellow-500/20",label:"엔터테인먼트"}},O=e=>{let{item:t}=e,a=_[t.category],l=a.icon;return(0,s.jsxs)("div",{className:"flex items-center gap-4 p-4 bg-slate-800 rounded-lg hover:bg-slate-750 transition-all duration-200 group",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 min-w-[100px]",children:[(0,s.jsx)(S,{className:"w-4 h-4 text-slate-400"}),(0,s.jsx)("span",{className:"text-sm font-medium text-slate-300",children:t.time})]}),(0,s.jsx)("div",{className:"p-2 rounded-lg ".concat(a.color),children:(0,s.jsx)(l,{className:"w-5 h-5"})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("h4",{className:"text-sm font-medium text-slate-100 mb-1",children:t.activity}),(0,s.jsxs)("div",{className:"flex items-center gap-2 text-xs text-slate-400",children:[(0,s.jsx)(c,{className:"w-3 h-3"}),(0,s.jsx)("span",{className:"truncate",children:t.location})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[t.cost&&(0,s.jsxs)("div",{className:"flex items-center gap-1 text-sm text-slate-300",children:[(0,s.jsx)(p,{className:"w-4 h-4 text-slate-400"}),(0,s.jsxs)("span",{children:[t.cost.amount.toLocaleString()," ",t.cost.currency]})]}),t.verified&&(0,s.jsxs)("div",{className:"flex items-center gap-1 bg-green-500/20 text-green-400 px-2 py-1 rounded text-xs font-medium",children:[(0,s.jsx)(A,{className:"w-3 h-3"}),(0,s.jsx)("span",{children:"확인됨"})]})]})]})},E=e=>{let{schedule:t,totalCost:a}=e;return(0,s.jsxs)("div",{className:"w-full",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-slate-100",children:"상세 일정"}),a&&(0,s.jsxs)("div",{className:"flex items-center gap-2 bg-slate-800 px-4 py-2 rounded-lg",children:[(0,s.jsx)(p,{className:"w-5 h-5 text-slate-400"}),(0,s.jsx)("span",{className:"text-sm text-slate-400",children:"총 예상 비용:"}),(0,s.jsxs)("span",{className:"text-lg font-bold text-slate-100",children:[a.amount.toLocaleString()," ",a.currency]})]})]}),(0,s.jsx)("div",{className:"space-y-6",children:t.map(e=>(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between sticky top-0 bg-slate-900 py-3 z-10",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"w-8 h-8 rounded-lg bg-blue-500/20 text-blue-400 flex items-center justify-center text-sm font-bold",children:e.dayNumber}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(o,{className:"w-4 h-4 text-slate-400"}),(0,s.jsx)("span",{className:"text-lg font-semibold text-slate-100",children:new Date(e.date).toLocaleDateString("ko-KR",{month:"long",day:"numeric",weekday:"short"})})]})]}),e.dailyCost&&(0,s.jsxs)("div",{className:"flex items-center gap-1 text-sm text-slate-300",children:[(0,s.jsx)(p,{className:"w-4 h-4 text-slate-400"}),(0,s.jsxs)("span",{children:[e.dailyCost.total.toLocaleString()," ",e.dailyCost.currency]})]})]}),(0,s.jsx)("div",{className:"space-y-2 pl-11",children:e.items.map(e=>(0,s.jsx)(O,{item:e},e.id))})]},e.date))})]})};var P=a(9733);function T(){let{tripState:e,isLoading:t,error:a,generateDestinations:n,selectDestination:r,selectPlan:c,refineTimeline:d,resetTrip:o,updateMetadata:m}=function(){let[e,t]=(0,l.useState)(i),[a,s]=(0,l.useState)(!1),[n,r]=(0,l.useState)(null),c=(0,l.useCallback)(async(e,a)=>{s(!0),r(null);try{let s=await fetch("/api/trip/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userInput:e,metadata:a})});if(!s.ok)throw Error("Failed to generate destinations: ".concat(s.statusText));let l=await s.json();t(t=>({...t,stage:"choose_destination",userInput:e,metadata:a,destinationOptions:l.destinations,conversation:[...t.conversation,{id:crypto.randomUUID(),role:"user",content:e,timestamp:new Date,metadata:{stage:"initial",action:void 0}}]}))}catch(e){r(e instanceof Error?e.message:"Failed to generate destinations"),console.error("Error generating destinations:",e)}finally{s(!1)}},[]),d=(0,l.useCallback)(async a=>{s(!0),r(null);try{let s=await fetch("/api/trip/select-destination",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({destination:a,metadata:e.metadata})});if(!s.ok)throw Error("Failed to select destination: ".concat(s.statusText));let l=await s.json();t(e=>({...e,stage:"choose_plan",selectedDestination:a,planOptions:l.plans,conversation:[...e.conversation,{id:crypto.randomUUID(),role:"user",content:"I'd like to visit ".concat(a.name,", ").concat(a.country),timestamp:new Date,metadata:{stage:"choose_destination",action:"select_destination",data:a}}]}))}catch(e){r(e instanceof Error?e.message:"Failed to select destination"),console.error("Error selecting destination:",e)}finally{s(!1)}},[e.metadata]),o=(0,l.useCallback)(async a=>{if(!e.selectedDestination)return void r("No destination selected");s(!0),r(null);try{let s=await fetch("/api/trip/select-plan",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({destination:e.selectedDestination,plan:a,metadata:e.metadata})});if(!s.ok)throw Error("Failed to select plan: ".concat(s.statusText));let l=await s.json();t(e=>({...e,stage:"itinerary_ready",selectedPlan:a,timeline:l.timeline,conversation:[...e.conversation,{id:crypto.randomUUID(),role:"user",content:"I'd like to go with Plan ".concat(a.label,": ").concat(a.name),timestamp:new Date,metadata:{stage:"choose_plan",action:"select_plan",data:a}},{id:crypto.randomUUID(),role:"assistant",content:l.initialMessage||"Great choice! Here's your personalized itinerary. You can chat with me to refine it.",timestamp:new Date,metadata:{stage:"itinerary_ready"}}]}))}catch(e){r(e instanceof Error?e.message:"Failed to select plan"),console.error("Error selecting plan:",e)}finally{s(!1)}},[e.selectedDestination,e.metadata]),m=(0,l.useCallback)(async a=>{if(!e.selectedDestination||!e.selectedPlan)return void r("No destination or plan selected");s(!0),r(null);let l={id:crypto.randomUUID(),role:"user",content:a,timestamp:new Date,metadata:{stage:"itinerary_ready",action:"modify_timeline"}};t(e=>({...e,conversation:[...e.conversation,l]}));try{let s=await fetch("/api/trip/refine",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:a,currentTimeline:e.timeline,destination:e.selectedDestination,plan:e.selectedPlan,metadata:e.metadata,conversationHistory:e.conversation})});if(!s.ok)throw Error("Failed to refine timeline: ".concat(s.statusText));let l=await s.json();t(e=>({...e,timeline:l.timeline,conversation:[...e.conversation,{id:crypto.randomUUID(),role:"assistant",content:l.response,timestamp:new Date,metadata:{stage:"itinerary_ready"}}]}))}catch(e){r(e instanceof Error?e.message:"Failed to refine timeline"),console.error("Error refining timeline:",e),t(e=>({...e,conversation:e.conversation.filter(e=>e.id!==l.id)}))}finally{s(!1)}},[e.selectedDestination,e.selectedPlan,e.timeline,e.metadata,e.conversation]);return{tripState:e,isLoading:a,error:n,generateDestinations:c,selectDestination:d,selectPlan:o,refineTimeline:m,resetTrip:(0,l.useCallback)(()=>{t(i),r(null)},[]),updateMetadata:(0,l.useCallback)(e=>{t(t=>({...t,metadata:{...t.metadata,...e}}))},[])}}();return(0,s.jsxs)("div",{className:"space-y-6",children:[a&&(0,s.jsxs)("div",{className:"bg-red-50 border border-red-200 text-red-800 px-4 py-3 rounded-lg dark:bg-red-950 dark:border-red-800 dark:text-red-200",children:[(0,s.jsx)("p",{className:"font-medium",children:"Error"}),(0,s.jsx)("p",{className:"text-sm mt-1",children:a})]}),"initial"===e.stage&&(0,s.jsx)(h,{onSubmit:e=>{let t={travelers:e.travelers||2,departureDate:e.startDate||"",returnDate:e.endDate||"",departureCity:e.origin||"",preferences:[]};n(e.query,t)},isLoading:t}),"choose_destination"===e.stage&&(0,s.jsx)(f,{destinations:e.destinationOptions.map(e=>({id:e.id,name:e.name,country:e.country,highlights:e.highlights,estimatedCost:e.estimatedBudget,weather:{temperature:e.weatherNote||"N/A",condition:"N/A"},matchScore:e.matchScore})),onSelect:t=>{let a=e.destinationOptions.find(e=>e.id===t.id);a&&r(a)}}),"choose_plan"===e.stage&&e.selectedDestination&&(0,s.jsx)(N,{plans:e.planOptions.map(e=>({id:e.id,label:e.label,name:e.name,description:e.description,pace:"intense"===e.pace?"active":e.pace,highlights:e.highlights,estimatedCost:{total:(e.estimatedCost.min+e.estimatedCost.max)/2,currency:e.estimatedCost.currency}})),onSelect:t=>{let a=e.planOptions.find(e=>e.id===t.id);a&&c(a)}}),"itinerary_ready"===e.stage&&e.selectedDestination&&e.selectedPlan&&(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,s.jsx)("div",{className:"lg:col-span-1",children:(0,s.jsx)(E,{schedule:Object.values(e.timeline.reduce((e,t)=>{let a=t.day;e[a]||(e[a]={date:t.date,dayNumber:t.day,items:[]});let s="activity";return"free"===t.category?s="activity":["transport","food","accommodation"].includes(t.category)&&(s=t.category),e[a].items.push({id:t.id,time:t.time,activity:t.activity,location:t.location,category:s,cost:t.cost,verified:t.verified}),e},{})).sort((e,t)=>e.dayNumber-t.dayNumber),totalCost:{amount:e.selectedPlan.estimatedCost.min,currency:e.selectedPlan.estimatedCost.currency}})}),(0,s.jsx)("div",{className:"lg:col-span-1",children:(0,s.jsx)(P.c,{messages:e.conversation,onSendMessage:d,disabled:t})})]}),t&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black/20 dark:bg-black/40 backdrop-blur-sm flex items-center justify-center z-50",children:(0,s.jsx)("div",{className:"bg-white dark:bg-zinc-800 rounded-lg p-6 shadow-xl",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),(0,s.jsxs)("p",{className:"text-zinc-900 dark:text-zinc-50 font-medium",children:["initial"===e.stage&&"Generating destination options...","choose_destination"===e.stage&&"Creating travel plans...","choose_plan"===e.stage&&"Building your itinerary...","itinerary_ready"===e.stage&&"Refining your trip..."]})]})})})]})}a(1721),a(9576),a(4435),a(5704),(0,r.A)("wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]),(0,r.A)("dumbbell",[["path",{d:"M17.596 12.768a2 2 0 1 0 2.829-2.829l-1.768-1.767a2 2 0 0 0 2.828-2.829l-2.828-2.828a2 2 0 0 0-2.829 2.828l-1.767-1.768a2 2 0 1 0-2.829 2.829z",key:"9m4mmf"}],["path",{d:"m2.5 21.5 1.4-1.4",key:"17g3f0"}],["path",{d:"m20.1 3.9 1.4-1.4",key:"1qn309"}],["path",{d:"M5.343 21.485a2 2 0 1 0 2.829-2.828l1.767 1.768a2 2 0 1 0 2.829-2.829l-6.364-6.364a2 2 0 1 0-2.829 2.829l1.768 1.767a2 2 0 0 0-2.828 2.829z",key:"1t2c92"}],["path",{d:"m9.6 14.4 4.8-4.8",key:"6umqxw"}]])},1721:(e,t,a)=>{"use strict";a.d(t,{c:()=>d});var s=a(5155),l=a(508),i=a(8192),n=a(2821),r=a(5889);function c(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,r.QP)((0,n.$)(t))}function d(e){let t,{message:a}=e,n="user"===a.role,r="assistant"===a.role;return(0,s.jsxs)("div",{className:c("flex w-full gap-3 px-4 py-3",n&&"flex-row-reverse"),children:[(0,s.jsx)("div",{className:c("flex h-8 w-8 shrink-0 items-center justify-center rounded-full",n&&"bg-blue-600 dark:bg-blue-500",r&&"bg-zinc-700 dark:bg-zinc-600"),children:n?(0,s.jsx)(l.A,{className:"h-5 w-5 text-white"}):(0,s.jsx)(i.A,{className:"h-5 w-5 text-white"})}),(0,s.jsxs)("div",{className:c("flex max-w-[70%] flex-col gap-1",n&&"items-end"),children:[(0,s.jsx)("div",{className:c("rounded-2xl px-4 py-2",n&&"bg-blue-600 text-white dark:bg-blue-500",r&&"bg-zinc-200 text-zinc-900 dark:bg-zinc-700 dark:text-zinc-100"),children:(0,s.jsx)("p",{className:"whitespace-pre-wrap break-words text-sm leading-relaxed",children:a.content})}),(0,s.jsx)("span",{className:"px-2 text-xs text-zinc-500 dark:text-zinc-400",children:(t=a.timestamp,new Intl.DateTimeFormat("ko-KR",{hour:"2-digit",minute:"2-digit"}).format(t))})]})]})}},2903:(e,t,a)=>{Promise.resolve().then(a.bind(a,1140))},4435:(e,t,a)=>{"use strict";a.d(t,{_:()=>n});var s=a(5155),l=a(5740);let i=[{id:"1",label:"2일차에 자유시간 추가",action:"add_free_time_day2"},{id:"2",label:"호텔 변경",action:"change_hotel"},{id:"3",label:"항공편 검색",action:"search_flights"},{id:"4",label:"예산 확인",action:"check_budget"}];function n(e){let{suggestions:t=i,onSelect:a,disabled:n=!1}=e;return 0===t.length?null:(0,s.jsxs)("div",{className:"border-t border-zinc-200 bg-zinc-50 p-4 dark:border-zinc-800 dark:bg-zinc-900/50",children:[(0,s.jsxs)("div",{className:"mb-2 flex items-center gap-2 text-xs font-medium text-zinc-600 dark:text-zinc-400",children:[(0,s.jsx)(l.A,{className:"h-3.5 w-3.5"}),(0,s.jsx)("span",{children:"빠른 액션"})]}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:t.map(e=>(0,s.jsx)("button",{onClick:()=>a(e.action),disabled:n,className:"rounded-full border border-zinc-300 bg-white px-4 py-2 text-sm font-medium text-zinc-700 transition-all hover:border-blue-500 hover:bg-blue-50 hover:text-blue-700 disabled:cursor-not-allowed disabled:opacity-50 dark:border-zinc-700 dark:bg-zinc-800 dark:text-zinc-300 dark:hover:border-blue-400 dark:hover:bg-blue-950 dark:hover:text-blue-300",children:e.label},e.id))})]})}},9576:(e,t,a)=>{"use strict";a.d(t,{V:()=>n});var s=a(5155),l=a(2115),i=a(8085);function n(e){let{onSend:t,disabled:a=!1,placeholder:n="메시지를 입력하세요..."}=e,[r,c]=(0,l.useState)(""),d=()=>{let e=r.trim();e&&!a&&(t(e),c(""))};return(0,s.jsxs)("div",{className:"flex items-end gap-2 border-t border-zinc-200 bg-white p-4 dark:border-zinc-800 dark:bg-zinc-900",children:[(0,s.jsx)("textarea",{value:r,onChange:e=>c(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),d())},placeholder:n,disabled:a,rows:1,className:"min-h-[40px] max-h-[120px] flex-1 resize-none rounded-lg border border-zinc-300 bg-white px-4 py-2 text-sm text-zinc-900 placeholder-zinc-500 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/20 disabled:cursor-not-allowed disabled:opacity-50 dark:border-zinc-700 dark:bg-zinc-800 dark:text-zinc-100 dark:placeholder-zinc-400 dark:focus:border-blue-400",style:{height:"auto",minHeight:"40px"},onInput:e=>{let t=e.target;t.style.height="auto",t.style.height="".concat(t.scrollHeight,"px")}}),(0,s.jsx)("button",{onClick:d,disabled:a||!r.trim(),className:"flex h-10 w-10 shrink-0 items-center justify-center rounded-lg bg-blue-600 text-white transition-colors hover:bg-blue-700 disabled:cursor-not-allowed disabled:opacity-50 dark:bg-blue-500 dark:hover:bg-blue-600",children:(0,s.jsx)(i.A,{className:"h-5 w-5"})})]})}},9733:(e,t,a)=>{"use strict";a.d(t,{c:()=>c});var s=a(5155),l=a(2115),i=a(1721),n=a(9576),r=a(4435);function c(e){let{messages:t,onSendMessage:a,onSuggestionSelect:c,disabled:d=!1,showSuggestions:o=!0}=e,m=(0,l.useRef)(null),x=(0,l.useRef)(null);return(0,l.useEffect)(()=>{var e;null==(e=m.current)||e.scrollIntoView({behavior:"smooth"})},[t]),(0,s.jsxs)("div",{className:"flex h-full flex-col overflow-hidden rounded-lg border border-zinc-200 bg-white shadow-lg dark:border-zinc-800 dark:bg-zinc-900",children:[(0,s.jsx)("div",{ref:x,className:"flex-1 overflow-y-auto",style:{scrollBehavior:"smooth"},children:0===t.length?(0,s.jsx)("div",{className:"flex h-full items-center justify-center p-8",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("p",{className:"text-lg font-medium text-zinc-400 dark:text-zinc-500",children:"여행 계획을 시작해보세요"}),(0,s.jsx)("p",{className:"mt-2 text-sm text-zinc-500 dark:text-zinc-400",children:"목적지나 여행 날짜를 입력하세요"})]})}):(0,s.jsxs)("div",{className:"flex flex-col",children:[t.map(e=>(0,s.jsx)(i.c,{message:e},e.id)),(0,s.jsx)("div",{ref:m})]})}),o&&(0,s.jsx)(r._,{onSelect:e=>{c&&c(e)},disabled:d}),(0,s.jsx)(n.V,{onSend:a,disabled:d})]})}}},e=>{e.O(0,[392,441,255,358],()=>e(e.s=2903)),_N_E=e.O()}]);